import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

# Self-Hosting

We provide a fully managed cloud instance of the Touca server at
https://app.touca.io. Since Touca is open-source, you can install it locally or
deploy it to your own cloud infrastructure. We've made the process
straightforward and self-serve. [Join us on Discord](https://touca.io/discord)
or [send us an email](mailto:support@touca.io) if you need help or had any
questions.

:::info

Most of our paid plans include dedicated support and professional services for
deploying and upgrading self-hosted instances of Touca.

:::

We support two different self-hosted deployments of Touca:

1. You can host Touca as a set of Docker containers on a single machine. This
   setup uses Docker Compose and is most suitable for individuals and small
   engineering teams.
2. You can deploy Touca to your Kubernetes cluster using our Helm chart. This
   setup is suitable for engineering teams who are used to hosting third-party
   tools on Kubernetes.

Both deployments use MinIO, MongoDB, and Redis as service dependencies. If you
plan on using Touca at scale, we encourage you to upgrade to our paid deployment
setups that use DocumentDB, ElastiCache and S3 instead.

## Using Docker Compose

### Installing

You can install Touca server locally using either the Touca CLI (recommended) or
our `install.sh` script, or using `docker compose` directly.

<Tabs
  defaultValue="python"
  groupId="self-hosted-install"
  values={[
    { label: "Using Touca CLI", value: "python" },
    { label: "Using Bash Script", value: "bash" },
    { label: "Using Docker Compose", value: "compose" },
  ]}
>
  <TabItem value="bash">

```bash
/bin/bash -c "$(curl -fsSL https://touca.io/install.sh)"
```

This command uses `docker-compose` to install the server into `~/.touca/server`
and run it. Once the install is over, navigate to Touca server and complete the
install wizard.

  </TabItem>
  <TabItem value="python">

The best way to manage Touca server is through our CLI.

```bash
pip install touca
```

The [`touca server`](../../cli/#server-management) subcommand helps you install,
upgrade, and uninstall the Touca server, as well as to check its status and
logs.

```bash
touca server install
```

This command uses `docker-compose` to install the server into `~/.touca/server`
and run it. Once the install is over, navigate to Touca server and complete the
install wizard.

  </TabItem>
  <TabItem value="compose">

If you prefer using `docker compose` directly, clone the GitHub repository for
Touca, create local directories for the server dependencies and use the
following commands to install the server in the current working directory.

```bash
git clone git@github.com:trytouca/trytouca.git
cd trytouca
mkdir -p data/{minio,mongo,redis}
export UID_GID="$(id -u):$(id -g)"
docker compose -f ops/docker-compose.test.yml --project-directory . -p touca up -d
```

  </TabItem>
</Tabs>

### Uninstalling

<Tabs
  defaultValue="python"
  groupId="self-hosted-install"
  values={[
    { label: "Using Touca CLI", value: "python" },
    { label: "Using Bash Script", value: "bash" },
    { label: "Using Docker Compose", value: "compose" },
  ]}
>
  <TabItem value="bash">

To uninstall the server, you can use the following command to stop the running
containers and remove all server data from the filesystem.

```bash
/bin/bash -c "$(curl -fsSL https://touca.io/install.sh)" -- --uninstall
```

Note the extra `--` before `--uninstall`.

  </TabItem>
  <TabItem value="python">

To uninstall the server, you can use the following command to stop the running
containers and remove all server data from the filesystem.

```bash
touca server uninstall
```

  </TabItem>
  <TabItem value="compose">

To uninstall the server, you can use the following command to stop the running
containers.

```bash
docker compose -f ops/docker-compose.prod.yml --project-directory . -p touca down
```

Remember to also remove directories for Touca server dependencies such as MinIO,
Mongo, and Redis.

  </TabItem>
</Tabs>

If you have any locally stored test results, you can manually remove them by
running `rm -r $HOME/.touca/results`.

## Using Helm

### Installing

You can use our Helm chart to deploy Touca to an existing Kubernetes cluster.

```bash
git clone git@github.com:trytouca/trytouca.git
cd ops/k8s/helm-chart
helm install <name> .
```

### Uninstalling

You can unintsall Touca the standard way:

```bash
helm uninstall <name>
```

:::info

Did we miss out a required step? We'd love to hear about your experience. Share
your thoughts with [support@touca.io](mailto:support@touca.io).

:::
