import ThemedImage from "@theme/ThemedImage";
import useBaseUrl from "@docusaurus/useBaseUrl";

# Running Tests

## Leveraging Continuous Integration

We can choose to run Touca Tests as part of our CI pipeline. Regardless of what
CI solution we use, we can add a step to our build pipeline that invokes Touca
tests with the appropriate API Key and API URL.

### Using Github Actions

If you are using **GitHub Actions**, create a new repository secret called
`TOUCA_API_KEY` in the "Settings" tab of your GitHub repository.

<ThemedImage
  sources={{
    light: useBaseUrl("img/assets/touca-automate-secret.png"),
    dark: useBaseUrl("img/assets/touca-automate-secret.png")
  }}
/>

Add the following steps to your GitHub Actions workflow:

```yaml
- name: Get version number
  id: params
  run: |
    git fetch --prune --unshallow --tags
    echo "version=$(git describe --tags --abbrev=4)" >> $GITHUB_OUTPUT
- name: Run sample Touca test
  if: github.ref == 'refs/heads/main'
  env:
    TOUCA_API_KEY: ${{ secrets.TOUCA_API_KEY }}
    TOUCA_API_URL: https://api.touca.io/@/<your-team>/<your-suite>
    TOUCA_TEST_VERSION: ${{ steps.params.outputs.version }}
  run: |
    ./sample_touca_test
```

Now every time you push changes to the `main` branch of your repository, your
tests will automatically run and submit results to the Touca server.

For a working prototype, check out our own
[GitHub Actions](https://github.com/trytouca/trytouca/blob/main/.github/workflows/build.yml#L709-L719)
which includes running sample Touca tests for different programming languages.

## Using a Dedicated Test Server

Running Touca tests as part of the CI is convenient but it has important
limitations:

- Running Touca tests at scale with a large set of test cases could be time
  consuming, leading to longer build times.
- Our test workflows may require access to input data that could be large in
  size and difficult to provision on a build server.
- Performance benchmarks obtained on a build server are prone to noise.

We can mitigate these limitations using a dedicated test server that can store
our input test data and run our tests continuously or on a fixed schedule.

If you prefer running tests on your own infrastructure, you can use the Touca
CLI command `touca run` that takes a recipe describing your software delivery
pipeline specification to download and deploy new releases of your sosftware and
to run your tests against it. Refer to the
[documentation](/cli/test/#running-tests-on-a-test-machine) for this CLI command
for more info.

:::info

For Touca enterprise customers, we provide the test infrastructure and tooling
required to remotely execute Touca tests at scale and based on custom
requirements.

:::
